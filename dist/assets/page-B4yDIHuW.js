import{i as L,j as S,y as g,s as T,f,A as $,u as e,S as x,L as j,r as w,d as b,c as A,l as B,m as R,k as _}from"./index-BAvY3pQe.js";import{I as q}from"./Image-BKAtRhsX.js";import{u as E}from"./useRequest--8xKAzyh.js";import{u as M}from"./useZoom-BuZnhkvD.js";const l=({children:a})=>e("div",{className:"absolute inset-0 m-auto flex flex-col items-center gap-1 size-fit text-zinc-400 transition dark:text-zinc-500",children:a}),W=()=>{var m;const{id:a}=L(),[P,i]=S(),{data:t,loading:N,error:r}=E(`/blogs/${a}`);g(()=>{t&&T(t.title)},[t]);const[c,v]=f(window.innerWidth>1280),[k,z]=f([]);g(()=>{if(!(t!=null&&t.content))return;if(window.location.hash){const s=document.getElementById(decodeURIComponent(window.location.hash.slice(1)));s==null||s.scrollIntoView()}const o=t.content.match(/<h\d.*>.*<\/h\d>/g);if(!o)return;const p=o.map(s=>+s[2]),y=Math.min(...p),h=[];o.forEach((s,C)=>{var u;const I=p[C],n=(u=s.match(new RegExp('(?<=id=").+(?=">)')))==null?void 0:u[0];n&&h.push({id:n,text:s.slice(10+n.length,-5),style:{transform:`translateX(${(I-y)*8}px)`}})}),z(h)},[t]);const d=$(null);return M(d,{reloadDeps:[t]}),r?e(l,{children:[e(x,{className:"w-32"}),e("span",{children:r.message}),e("button",{className:"px-8 py-2 mt-5",onClick:()=>i("/blogs"),children:"回到列表"})]}):N?e(l,{children:e(j,{})}):t?e(_,{children:[e("figure",{className:"relative w-full aspect-[18/9] sm:aspect-[28/9] lg:aspect-[32/9] xl:aspect-[40/9] rounded-xl overflow-hidden",children:[e(q,{src:`/Blogs/${a}.webp`,className:"size-full"}),e("figcaption",{className:"absolute top-0 left-0 flex flex-col items-center justify-center gap-0.5 size-full md:pb-16 p-3 bg-black/50",children:[e("h1",{className:"mb-3 text-white text-balance text-center",children:t.title}),e("span",{className:"text-sm text-zinc-200",children:[w(b(parseInt(t.id??"",36)).fromNow()),"创建 / ",w(b(t.updated).fromNow()),"更新"]}),e("span",{className:"text-sm text-zinc-200",children:["全篇约",t.minutes??0,"分钟 / ",(((m=t.content)==null?void 0:m.length)??0)>>1,"字符"]})]})]}),e("article",{ref:d,className:"prose prose-zinc prose-img:inline prose-img:max-h-96 prose-img:mr-3 prose-img:mt-0 prose-img:mb-3 prose-img:shadow prose-img:rounded-xl prose-pre:rounded-xl md:-translate-y-20 p-5 mx-auto rounded-xl shadow-xl bg-white overflow-x-hidden transition dark:prose-invert prose-blockquote:dark:border-s-zinc-500 prose-pre:dark:bg-zinc-900 dark:bg-zinc-700",dangerouslySetInnerHTML:{__html:t.content??""}}),e("div",{className:"fixed bottom-3 right-6 flex flex-col items-end gap-3",children:[e("div",{className:A("max-h-96 max-w-72 p-3 rounded-xl shadow-lg bg-white overflow-x-hidden overflow-y-auto transition-all dark:bg-zinc-700",!c&&"invisible opacity-0"),children:k.map(o=>e("a",{href:`#${o.id}`,style:o.style,className:"block text-zinc-700 truncate transition dark:text-zinc-200",children:o.text}))}),e(B,{value:c,onChange:v}),e("button",{onClick:()=>window.scrollTo(0,0),children:e(R,{className:"size-5 rotate-90"})})]})]}):e(l,{children:[e(x,{className:"w-32"}),e("span",{children:"空空如也"}),e("button",{className:"px-8 py-2 mt-5",onClick:()=>i("/blogs"),children:"回到列表"})]})};export{W as default};
