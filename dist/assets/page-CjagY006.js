import{_ as l,f as u,y,u as e,L as C,k,H as D,h as S,I as L,C as p,J as b,v as M}from"./index-BAvY3pQe.js";import{T as j}from"./Tabs-GcNR0JzV.js";const B=a=>l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...a},l("g",{fill:"none",fillRule:"evenodd"},l("path",{d:"M24 0v24H0V0zM12.6 23.3h-.2v.5h.2v-.5m.3-.2-.2.1v.5l.2.1v-.6m-.8 0v.6h.2v-.5z"}),l("path",{fill:"currentColor",d:"M10.5 2a8.5 8.5 0 1 0 5.3 15.2l3.6 3.6a1 1 0 0 0 1.4-1.4l-3.6-3.6A8.5 8.5 0 0 0 10.5 2M4 10.5a6.5 6.5 0 1 1 13 0 6.5 6.5 0 0 1-13 0"}))),f=a=>l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...a},l("g",{fill:"none",fillRule:"evenodd"},l("path",{d:"M24 0v24H0V0h24ZM12.6 23.3h-.2v.5h.2v-.5Zm.3-.2-.2.1v.5l.2.1v-.6Zm-.8 0v.7h.2v-.5l-.2-.2Z"}),l("path",{fill:"#09244BFF",d:"M8.3 12.7a1 1 0 0 1 0-1.4l5.6-5.7a1 1 0 1 1 1.5 1.5l-5 4.9 5 5a1 1 0 0 1-1.4 1.4l-5.7-5.7Z"}))),w=({title:a,request:t,postData:i,dataKey:n,actions:d})=>{const[s,h]=u(),[c,m]=u(1),[x,N]=u(""),v=async r=>{if(!t||!n)return;const o=await t({page:r??c,keyword:x}),g=i?i(o[n]):o[n];h({...o,[n]:g}),m(o.page)};return y(()=>{v()},[c,x]),s?e("div",{className:"flex flex-col border rounded-xl transition dark:border-zinc-700",children:[e("div",{className:"flex items-center justify-between p-3",children:[e("h4",{className:"text-zinc-800 dark:text-zinc-100",children:a||"未命名表格"}),e("div",{className:"relative",children:[e(B,{className:"absolute top-0 bottom-0 left-2.5 my-auto size-4 text-zinc-600 pointer-events-none transition dark:text-zinc-300"}),e("input",{type:"text",className:"pl-8 rounded-lg border-zinc-200 text-sm transition placeholder:transition dark:border-zinc-700 dark:bg-zinc-700 dark:text-white dark:placeholder:text-zinc-200",placeholder:"搜索关键词...",onKeyPress:r=>r.key==="Enter"&&N(r.currentTarget.value)})]})]}),s&&n&&s[n]&&e(k,{children:[e("div",{className:"overflow-x-auto",children:e("table",{className:"min-w-full",children:[e("thead",{className:"border-y bg-zinc-50 transition dark:border-zinc-700 dark:bg-zinc-700",children:e("tr",{children:[Object.keys(s[n][0]??{}).map(r=>e("th",{className:"p-3 font-medium text-start text-sm text-zinc-500 transition dark:text-zinc-400",children:D(r)},r)),(d==null?void 0:d.length)&&e("th",{className:"p-3 font-medium text-start text-sm text-zinc-500 transition dark:text-zinc-400",children:"Actions"})]})}),e("tbody",{children:s[n].map(r=>e("tr",{className:"border-b transition hover:bg-zinc-50 dark:border-zinc-800 dark:hover:bg-zinc-800",children:[Object.values(r).map((o,g)=>e("td",{className:"px-3 py-2 text-zinc-800 whitespace-nowrap transition dark:text-zinc-200",children:o??"-"},`${r.id}.${g}`)),d&&e("td",{className:"flex gap-1.5 py-2 pr-3",children:d(r,()=>v(1))})]},r.id))})]})}),e("div",{className:"flex items-center justify-between gap-1.5 p-3",children:[e("span",{className:"text-sm text-zinc-400 tracking-wider transition dark:text-zinc-500",children:["第",c,"/",s.pages,"页"]}),e("div",{className:"flex gap-1.5",children:[e("button",{disabled:c===1,onClick:()=>m(c-1),children:e(f,{className:"size-5"})}),e("button",{disabled:c===s.pages,onClick:()=>m(c+1),children:e(f,{className:"size-5 rotate-180"})})]})]})]})]}):e(C,{className:"static min-h-96 border rounded-xl transition dark:border-zinc-700"})},z=({name:a,accept:t,placeholder:i,className:n,onChange:d})=>e(k,{children:[e("input",{hidden:!0,type:"file",name:a,accept:t||"*",onChange:s=>{const h=new FormData,[c]=s.target.files;h.append(a,c),d(h)}}),e("button",{onClick:s=>s.target.previousSibling.click(),className:n,children:i||"上传文件"})]}),T=()=>e(j,{names:["文章","番剧"],className:"flex-1 overflow-x-hidden",tabClassName:"w-fit",children:[e(w,{title:"文章管理",dataKey:"blogs",request:S,postData:a=>a.map(t=>(t.updated=new Date(t.updated).toLocaleString(),t.created=new Date(parseInt(t.id,36)).toLocaleString(),t)),actions:(a,t)=>[e("button",{className:"px-2 py-1.5 rounded-xl text-sm whitespace-nowrap",onClick:()=>{L({...a,visibility:+!a.visibility}).then(()=>{p.success("操作成功"),t()}).catch(i=>p.error(i.message))},children:"设置可见性"}),e(z,{name:"banner",accept:"image/png, image/jpeg",placeholder:"上传封面",className:"px-2 py-1.5 rounded-xl text-sm whitespace-nowrap",onChange:i=>{b(`/blogs/${a.id}`,i).then(()=>p.success("上传成功")).catch(n=>p.error(n.message))}})]},"blogs"),e(w,{title:"番剧管理",dataKey:"animes",request:M,postData:a=>a.map(t=>(t.updated=new Date(t.updated).toLocaleString(),t.created=new Date(parseInt(t.id,36)).toLocaleString(),t)),actions:a=>[e(z,{name:"banner",accept:"image/png, image/jpeg",placeholder:"上传封面",className:"px-2 py-1.5 rounded-xl text-sm whitespace-nowrap",onChange:t=>{b(`/animes/${a.id}`,t).then(()=>p.success("上传成功")).catch(i=>p.error(i.message))}})]},"animes")]});export{T as default};
